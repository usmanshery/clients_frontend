(this["webpackJsonpvideofbweb-clients"]=this["webpackJsonpvideofbweb-clients"]||[]).push([[0],{135:function(e,t,a){e.exports=a(175)},168:function(e,t,a){},170:function(e,t,a){},175:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(11),i=a.n(s),o=a(14),l=a(13),c=a(19),u=a(22),m=a(21),d=a(3),p=a(48),g=a(7),h=a(43),v=a(112),b=Object(h.b)("apiCall"),f=(Object(h.b)("apiSyncCall"),Object(h.b)("apiCallFailure"),{user:"user",video:"video",campaign:"campaign",passwordReset:"passwordReset",login:"login",register:"register"}),y=["user"],E="All",C="Active",k="Inactive",O="New",N="All",j="Active",_="Past",w="New",P="videostuff",R=function(e){return!!/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(e)},U={loading:!1,loggedIn:!1,activeModule:null,userFilter:E,campaignFilter:N,userData:{name:null,email:null,admin:!1,key:null,bucketFolder:null}},x=new v.a,F=Object(h.c)({name:"session",initialState:U,reducers:{onPageLoad:function(e,t){var a;if(!t.payload.success)return x.set("activeModule",f.login),a=f.login,Object(g.a)(Object(g.a)({},e),{},{loading:!1,loggedIn:!1,activeModule:a,userData:{}});(a=x.get("activeModule"))||(x.set("activeModule",f.video),a=f.video);var n=t.payload,r=n.name,s=n.email,i=n.admin,o=n.key,l=n.bucketFolder;return a!==f.user||i||(a=f.video,x.set("activeModule",f.video)),a===f.campaign&&i&&(a=f.video,x.set("activeModule",f.video)),Object(g.a)(Object(g.a)({},e),{},{loading:!1,loggedIn:!0,activeModule:a,userData:{name:r,email:s,admin:i,key:o,bucketFolder:l}})},onLogin:function(e,t){if(!t.payload.success)return Object(g.a)(Object(g.a)({},e),{},{loading:!1,loggedIn:!1,userData:{}});var a=t.payload,n=a.name,r=a.email,s=a.admin,i=a.key,o=a.bucketFolder,l=s?f.user:f.campaign;return x.set("activeModule",l),Object(g.a)(Object(g.a)({},e),{},{loading:!1,loggedIn:!0,activeModule:l,userData:{name:n,email:r,admin:s,key:i,bucketFolder:o}})},onLogout:function(e,t){return t.payload.success?(x.set("activeModule",f.login),{loading:!1,loggedIn:!1,activeModule:null,userFilter:E,campaignFilter:N,userData:{name:null,email:null,admin:!1,key:null,bucketFolder:null}}):e},onNevigate:function(e,t){if(!(t.payload.to in f))return e;if(e.admin&&!function(e){return y.includes(e)}(t.payload.to))return e;var a=t.payload.to;return x.set("activeModule",a),Object(g.a)(Object(g.a)({},e),{},{activeModule:a})},onFetchUsers:function(e,t){return t.payload.success?Object(g.a)(Object(g.a)({},e),{},{userPoolData:t.payload.users}):e},onUserFilter:function(e,t){return Object(g.a)(Object(g.a)({},e),{},{userFilter:t.payload.filter})},onVideoFilter:function(e,t){return Object(g.a)(Object(g.a)({},e),{},{albumUrl:t.payload.filter,albumName:t.payload.name})},onCampaignFilter:function(e,t){return Object(g.a)(Object(g.a)({},e),{},{campaignFilter:t.payload.filter})},onFetchCampaigns:function(e,t){if(!t.payload.success)return e;var a=e.userData.admin?t.payload.campaigns.map((function(e){return{name:e.user,campaigns:e.campaigns.map((function(e){return{campaignName:e.name,campaignUrl:e.campaignURL}}))}})):t.payload.campaigns;return Object(g.a)(Object(g.a)({},e),{},{campaignList:a})},onFetchVideoList:function(e,t){return t.payload.success?Object(g.a)(Object(g.a)({},e),{},{loading:!1,albumList:t.payload.videos}):Object(g.a)(Object(g.a)({},e),{},{loading:!1})},onRemoveVideo:function(e,t){return t.payload.success?Object(g.a)(Object(g.a)({},e),{},{loading:!1,albumList:e.albumList.filter((function(e){return e.key!==t.payload.videoKey}))}):Object(g.a)(Object(g.a)({},e),{},{loading:!1})},onSelectAlbum:function(e,t){return Object(g.a)(Object(g.a)({},e),{},{albumName:t.payload.albumName})},onFetchVideoUrl:function(e,t){return t.payload.success?Object(g.a)(Object(g.a)({},e),{},{loading:!1,videoUrl:t.payload.videoUrl}):Object(g.a)(Object(g.a)({},e),{},{loading:!1})},onClearVideoUrl:function(e,t){return Object(g.a)(Object(g.a)({},e),{},{loading:!1})},onWaitAction:function(e,t){return Object(g.a)(Object(g.a)({},e),{},{loading:!0})}}}),M=F.actions,I=M.onPageLoad,S=M.onLogin,L=M.onLogout,q=M.onFetchUsers,D=M.onNevigate,A=(M.onExistingUserCheck,F.actions),B=A.onFetchCampaigns,V=A.onFetchVideoList,T=(A.onFetchVideoUrl,A.onRemoveVideo),z=A.onClearVideoUrl,J=A.onSelectAlbum,H=F.actions,W=H.onCampaignFilter,$=(H.onVideoFilter,H.onUserFilter),Z=F.actions.onWaitAction,G=F.reducer,K="http://clients.patronish.com:4000",Q=K+"/campaigns",X={"Content-Type":"application/json"},Y="GET",ee="PUT",te="POST",ae="DELETE",ne=function(e,t){return b({url:"http://clients.patronish.com:4000/users/userExists/"+e,callParams:{method:Y,headers:X,credentials:"include"},cb:t})},re=function(e){return D({to:e})},se=function(e){return $({filter:e})},ie=function(e){return W({filter:e})},oe=function(e){return b({url:Q+"/getUserCampaigns/"+e,callParams:{method:Y,headers:X,credentials:"include"},onSuccess:B.type,onFailure:B.type})},le=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={collapseID:""},e.toggleCollapse=function(t){return function(){return e.setState((function(e){return{collapseID:e.collapseID!==t?t:""}}))}},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(p.a,null,r.a.createElement(d.e,null,r.a.createElement(d.k,{color:"blue",dark:!0,expand:"md",scrolling:!0,fixed:"top"},r.a.createElement(d.l,null,r.a.createElement("strong",{className:"white-text"},"Patronish")),r.a.createElement(d.n,{onClick:this.toggleCollapse("navbarCollapse")}),r.a.createElement(d.d,{id:"navbarCollapse",isOpen:this.state.collapseID,navbar:!0},r.a.createElement(d.m,{left:!0},r.a.createElement(d.j,{active:this.props.activeModule===f.user,style:{display:this.props.admin?"":"none"}},r.a.createElement(d.i,{to:"",onClick:function(){return e.props.navigate(f.user)},link:!0},"Users")),r.a.createElement(d.j,{active:this.props.activeModule===f.video},r.a.createElement(d.i,{to:"",onClick:function(){return e.props.navigate(f.video)},link:!0},"Videos")),r.a.createElement(d.j,{active:this.props.activeModule===f.campaign,style:{display:this.props.admin?"none":""}},r.a.createElement(d.i,{to:"",onClick:function(){return e.props.navigate(f.campaign)},link:!0},"Campaign"))),r.a.createElement(d.m,{right:!0},r.a.createElement(d.j,null,r.a.createElement(d.i,{to:"",onClick:this.props.logout,link:!0},"Logout")),r.a.createElement(d.j,null,r.a.createElement(d.i,{to:"",active:!1,onClick:function(){console.log("nav link click event")},link:!0},r.a.createElement(d.f,{far:!0,icon:"user"}),this.props.username)))))))}}]),a}(n.Component),ce=Object(m.b)((function(e){return{username:e.userData.name,admin:e.userData.admin,activeModule:e.activeModule}}),(function(e){return{logout:function(){return e(b({url:"http://clients.patronish.com:4000/users/logout",callParams:{method:te,headers:X,credentials:"include"},onSuccess:L.type,onFailure:L.type}))},navigate:function(t){return e(re(t))}}}))(le),ue=a(28),me=(a(166),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.campaignList||(this.props.isAdmin?this.props.fetchCampaigns("*"):this.props.fetchCampaigns(this.props.userEmail))}},{key:"generateUserVideoMenu",value:function(){var e=this,t=this.props.campaignList?this.props.campaignList.map((function(t){return r.a.createElement(d.i,{to:"",onClick:function(){e.props.overlay(),e.props.setAlbumName(t.name),e.props.filterVideos(t.campaignURL)},link:!0},t.name)})):[];return r.a.createElement(ue.a,null,r.a.createElement(ue.d,{title:"Video Folders"},r.a.createElement(d.j,{active:this.props.videoMenu===P},t)))}},{key:"generateAdminVideoMenu",value:function(){var e=this,t=this.props.campaignList?this.props.campaignList.map((function(t){var a=t.campaigns.map((function(t){return r.a.createElement(d.i,{to:"",onClick:function(){e.props.overlay(),e.props.setAlbumName(t.campaignName),e.props.filterVideos(t.campaignUrl)},link:!0},t.campaignName)}));return r.a.createElement(ue.d,{title:t.name},r.a.createElement(d.j,{active:e.props.videoMenu===P},a))})):[];return r.a.createElement(ue.a,null,t)}},{key:"render",value:function(){var e=this,t=r.a.createElement(ue.a,null,r.a.createElement(ue.d,{defaultOpen:!0,title:"Filter Users"},r.a.createElement(d.j,{active:this.props.userMenu===E},r.a.createElement(d.i,{to:"",onClick:function(){return e.props.filterUsers(E)},link:!0},"All Users")),r.a.createElement(d.j,{active:this.props.userMenu===C},r.a.createElement(d.i,{to:"",onClick:function(){return e.props.filterUsers(C)},link:!0},"Active Users")),r.a.createElement(d.j,{active:this.props.userMenu===k},r.a.createElement(d.i,{to:"",onClick:function(){return e.props.filterUsers(k)},link:!0},"Inactive Users"))),r.a.createElement(d.j,{active:this.props.userMenu===O},r.a.createElement(d.i,{to:"",onClick:function(){return e.props.filterUsers(O)},link:!0},"Add New User"))),a=this.props.isAdmin?this.generateAdminVideoMenu():this.generateUserVideoMenu(),n=r.a.createElement(ue.a,null,r.a.createElement(ue.d,{defaultOpen:!0,title:"Filter Campaigns"},r.a.createElement(d.j,{active:this.props.campaignMenu===N},r.a.createElement(d.i,{to:"",onClick:function(){return e.props.filterCampaigns(N)},link:!0},"All Campaigns")),r.a.createElement(d.j,{active:this.props.campaignMenu===j},r.a.createElement(d.i,{to:"",onClick:function(){return e.props.filterCampaigns(j)},link:!0},"Active Campaigns")),r.a.createElement(d.j,{active:this.props.campaignMenu===_},r.a.createElement(d.i,{to:"",onClick:function(){return e.props.filterCampaigns(_)},link:!0},"Past Campaigns"))),r.a.createElement(d.j,{active:this.props.campaignMenu===w},r.a.createElement(d.i,{to:"",onClick:function(){return e.props.filterCampaigns(w)},link:!0},"Add New Campaign")));return r.a.createElement("div",{className:"",style:{position:"fixed",bottom:0,left:0,top:0}},r.a.createElement(p.a,null,r.a.createElement(ue.c,{width:270},r.a.createElement(ue.a,null,r.a.createElement(ue.b,null),r.a.createElement(ue.b,null),r.a.createElement(ue.b,null)),this.props.activeModule===f.user?t:r.a.createElement(r.a.Fragment,null),this.props.activeModule===f.video?a:r.a.createElement(r.a.Fragment,null),this.props.activeModule===f.campaign?n:r.a.createElement(r.a.Fragment,null))))}}]),a}(n.Component)),de=Object(m.b)((function(e){return{activeModule:e.activeModule,userMenu:e.userFilter,campaignList:e.campaignList,campaignMenu:e.campaignFilter,userEmail:e.userData.email,isAdmin:e.userData.admin}}),(function(e){return{fetchCampaigns:function(t){return e(oe(t))},filterUsers:function(t){return e(se(t))},filterVideos:function(t){return e(b({url:Q+"/getCampaignVideosList/"+t,callParams:{method:Y,headers:X,credentials:"include"},onSuccess:V.type,onFailure:V.type}))},filterCampaigns:function(t){return e(ie(t))},setAlbumName:function(t){return e(function(e){return J({albumName:e})}(t))},overlay:function(){return e(Z())}}}))(me),pe=a(9),ge=a(10),he=a(114),ve=a(69),be=a(5),fe=a(77),ye=a(78);function Ee(){var e=Object(fe.a)(["\n  list-style: none;\n  display: block;\n  padding: 4px 8px 4px 16px;\n  overflow: hidden;\n  color: inherit;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  font-size: 14px;\n  line-height: 1.5;\n  cursor: pointer;\n\n  &:hover {\n    background-color: #359ed0;\n    color: white;\n  }\n"]);return Ee=function(){return e},e}function Ce(){var e=Object(fe.a)(["\n  transition: color 0.15s, background-color 0.15s, width 0.25s ease-in-out;\n  position: absolute;\n  width: 160px;\n  padding: 4px 0px;\n  list-style: none;\n  background-clip: padding-box;\n  border-radius: 4px;\n  box-shadow: 0 1px 15px rgba(27, 31, 35, 0.15);\n  margin: 0;\n  background-color: white;\n  color: #333;\n  border: 1px solid rgba(27, 31, 35, 0.15);\n"]);return Ce=function(){return e},e}function ke(e){var t="-50%",a=0;"left"===e?(t="-3.5px",a="-50%"):"right"===e&&(t="3.5px",a="-50%");return"translate(".concat(t,", ").concat(a,") rotate(").concat({top:180,right:-90,left:90,bottom:0}[e],"deg)")}var Oe={top:{x:0,y:-20},left:{x:-20,y:0},bottom:{x:0,y:20},right:{x:20,y:0}},Ne=Object(ye.a)(ve.b.ul)(Ce()),je=function(e){return r.a.createElement("svg",Object.assign({width:14,height:7},e),r.a.createElement("g",{fill:"none",fillRule:"evenodd"},r.a.createElement("path",{fill:"#CDCFD0",d:"M7 .07v1.428l-5.55 5.5L0 6.982zM7 .07v1.428l5.55 5.5L14 6.982z"}),r.a.createElement("path",{fill:"#FFF",d:"M1.45 7L7 1.498 12.55 7z"})))},_e=r.a.forwardRef((function(e,t){var a=e.className,n=e.style,s=e.arrowStyle,i=e.layerSide,o=e.children;return r.a.createElement(Ne,{ref:t,className:a,style:n,initial:Object(g.a)({opacity:0,scale:.85},Oe[i]),animate:{opacity:1,scale:1,x:0,y:0},exit:Object(g.a)({opacity:0,scale:.85},Oe[i]),transition:{type:"spring",stiffness:800,damping:35}},o,r.a.createElement(je,{style:Object(g.a)(Object(g.a)({},s),{},{position:"absolute",transformOrigin:"center",transform:ke(i)})}))})),we=ye.a.li(Ee());function Pe(e){var t=e.className,a=e.style,n=e.children,s=Object(be.a)(e,["className","style","children"]);return r.a.createElement(we,Object.assign({className:t,style:a},s),n)}var Re=_e;function Ue(e){return r.a.createElement(he.a,{closeOnOutsideClick:!0,renderLayer:function(t){var a=e.options.map((function(a){return r.a.createElement(Pe,{onClick:function(){e.callback(a.action,e.id),t.close()},key:a.action},a.name())}));return r.a.createElement(ve.a,null,t.isOpen?r.a.createElement(Re,{ref:t.layerProps.ref,style:t.layerProps.style,arrowStyle:t.arrowStyle,layerSide:t.layerSide},a):null)},placement:{anchor:"LEFT_TOP",autoAdjust:!0,snapToAnchor:!1,triggerOffset:12,scrollOffset:16,preferX:"RIGHT"}},e.trigger)}var xe=a(222),Fe=a(204),Me=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).columns=[{label:"#",field:"id"},{label:"Company",field:"companyName"},{label:"User Name",field:"contactPersonName"},{label:"Email",field:"contactPersonEmail"},{label:"Active",field:"active"},{label:"Manage",field:"manage"}],n.userManagementActions={toggleActive:"toggleActive",removeUser:"removeUser",addUser:"addUser"},n.state={rows:[],active:!1},n.manageUser=n.manageUser.bind(Object(ge.a)(n)),n.onChange=n.onChange.bind(Object(ge.a)(n)),n.resetForm=n.resetForm.bind(Object(ge.a)(n)),n.resetForm=n.resetForm.bind(Object(ge.a)(n)),n.checkUserExistsResponse=n.checkUserExistsResponse.bind(Object(ge.a)(n)),n.addUserResponse=n.addUserResponse.bind(Object(ge.a)(n)),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.userData||this.props.fetchUsers()}},{key:"onChange",value:function(e,t){this.setState(Object(pe.a)({},e,t));var a=document.getElementById("".concat(e,"_err_msg"));a&&(a.style.display="none","contactPersonEmail"===e&&(document.getElementById("contactPersonEmailExists_err_msg").style.display="none"))}},{key:"checkUserExistsResponse",value:function(e){if(console.log("response: ",e),e.success)document.getElementById("contactPersonEmailExists_err_msg").style.display="block";else{var t=this.state,a=t.companyName,n=t.location,r=t.postCode,s=t.country,i=t.employeeSize,o=t.contactPersonName,l=t.contactPersonEmail,c=t.contactPersonRole,u=t.contactPersonNumber,m={name:o,email:l,password:t.password,role:c,contact:u,company:{name:a,location:n,postCode:r,country:s,employeeSize:i||-1},active:t.active};console.log("new user: ",m),this.props.addUser(m,this.addUserResponse)}}},{key:"addUserResponse",value:function(e){console.log("response: ",e),e.success&&(this.state.active&&this.props.filterUsers(C),this.state.active||this.props.filterUsers(k),this.props.fetchUsers())}},{key:"manageUser",value:function(e,t){var a;switch(e){case this.userManagementActions.toggleActive:return(a=Object(g.a)({},this.props.userData.find((function(e){return e.email===t})))).active=!a.active,void this.props.updateUser(t,a);case this.userManagementActions.removeUser:return a=Object(g.a)({},this.props.userData.find((function(e){return e.email===t}))),void this.props.removeUser(a);case this.userManagementActions.addUser:if(!this.state.companyName)return void(document.getElementById("companyName_err_msg").style.display="block");if(!this.state.location)return void(document.getElementById("location_err_msg").style.display="block");if(!this.state.postCode)return void(document.getElementById("postCode_err_msg").style.display="block");if(!this.state.country)return void(document.getElementById("country_err_msg").style.display="block");if(!this.state.contactPersonName)return void(document.getElementById("contactPersonName_err_msg").style.display="block");if(!this.state.contactPersonEmail)return void(document.getElementById("contactPersonEmail_err_msg").style.display="block");if(!R(this.state.contactPersonEmail))return void(document.getElementById("contactPersonEmail_err_msg").style.display="block");if(this.props.existingUserCheck)return;return this.state.contactPersonRole?this.state.contactPersonNumber?this.state.password?this.state.password!==this.state.password_re?void(document.getElementById("password_re_err_msg").style.display="block"):void this.props.checkUserExists(this.state.contactPersonEmail,this.checkUserExistsResponse):void(document.getElementById("password_err_msg").style.display="block"):void(document.getElementById("contactPersonNumber_err_msg").style.display="block"):void(document.getElementById("contactPersonRole_err_msg").style.display="block");default:return void console.log("will act as default")}}},{key:"resetForm",value:function(){this.setState({companyName:"",location:"",postCode:"",country:"",employeeSize:"",contactPersonName:"",contactPersonEmail:"",contactPersonRole:"",contactPersonNumber:"",password:"",password_re:"",active:!1})}},{key:"render",value:function(){var e=this;if(this.props.userFilter===E||this.props.userFilter===C||this.props.userFilter===k){var t;if(this.props.userData&&this.props.userData.length>0){var a=1;t=this.props.userData.map((function(t){return e.props.userFilter!==C||t.active?e.props.userFilter===k&&t.active?{}:{id:a++,companyName:t.company.name,contactPersonName:t.name,contactPersonEmail:t.email,active:(n=t.active,r.a.createElement(d.b,{size:"sm",rounded:!0,color:n?"success":"danger"},n?"Active":"Inactive")),action:r.a.createElement(Ue,{trigger:function(e){e.isOpen;var t=e.triggerRef,a=e.toggle;return r.a.createElement("button",{type:"button",className:"btn btn-outline-primary","data-ripple-color":"dark",ref:t,onClick:a},"Manage User")},id:t.email,options:[{name:function(){return t.active?"Deactivate User":"Activate User"},action:e.userManagementActions.toggleActive},{name:function(){return"Remove User"},action:e.userManagementActions.removeUser}],callback:e.manageUser})}:{};var n}))}return r.a.createElement(d.r,{btn:!0},r.a.createElement(d.t,{columns:this.columns}),r.a.createElement(d.s,{rows:t}))}if(this.props.userFilter===O)return r.a.createElement("form",{className:"needs-validation",onSubmit:function(t){t.preventDefault(),e.manageUser(e.userManagementActions.addUser)}},r.a.createElement(d.e,null,r.a.createElement(d.q,null,r.a.createElement(d.c,{md:"12"},r.a.createElement("p",{id:"x",className:"h5 text-center mb-4"},"Company"),r.a.createElement(d.h,{label:"Company Name",group:!0,value:this.state.companyName,onChange:function(t){return e.onChange("companyName",t.target.value)}}),r.a.createElement("div",{id:"companyName_err_msg",className:"invalid-feedback"},"Required"),r.a.createElement(d.h,{label:"Location",group:!0,value:this.state.location,onChange:function(t){return e.onChange("location",t.target.value)}}),r.a.createElement("div",{id:"location_err_msg",className:"invalid-feedback"},"Required"))),r.a.createElement(d.q,null,r.a.createElement(d.c,{md:"4"},r.a.createElement(d.h,{label:"Post Code",group:!0,type:"number",value:this.state.postCode,onChange:function(t){return e.onChange("postCode",t.target.value)}}),r.a.createElement("div",{id:"postCode_err_msg",className:"invalid-feedback"},"Required")),r.a.createElement(d.c,{md:"4"},r.a.createElement(d.h,{label:"Country",group:!0,value:this.state.country,onChange:function(t){return e.onChange("country",t.target.value)}}),r.a.createElement("div",{id:"country_err_msg",className:"invalid-feedback"},"Required")),r.a.createElement(d.c,{md:"4"},r.a.createElement(d.h,{label:"Employee Size",group:!0,value:this.state.employeeSize,onChange:function(t){return e.onChange("employeeSize",t.target.value)}}))),r.a.createElement(d.q,null,r.a.createElement(d.c,null,r.a.createElement("p",{id:"x",className:"h5 text-center mb-4 mt-3"},"Contact Person (Account Holder)"),r.a.createElement(d.h,{label:"Name",group:!0,value:this.state.contactPersonName,onChange:function(t){return e.onChange("contactPersonName",t.target.value)}}),r.a.createElement("div",{id:"contactPersonName_err_msg",className:"invalid-feedback"},"Required"))),r.a.createElement(d.q,null,r.a.createElement(d.c,{md:"4"},r.a.createElement(d.h,{label:"Email (used as login credential)",group:!0,type:"email",value:this.state.contactPersonEmail,onChange:function(t){return e.onChange("contactPersonEmail",t.target.value)}}),r.a.createElement("div",{id:"contactPersonEmail_err_msg",className:"invalid-feedback"},"Required"),r.a.createElement("div",{id:"contactPersonEmailExists_err_msg",className:"invalid-feedback"},"Email address already in use")),r.a.createElement(d.c,{md:"4"},r.a.createElement(d.h,{label:"Role",group:!0,value:this.state.contactPersonRole,onChange:function(t){return e.onChange("contactPersonRole",t.target.value)}}),r.a.createElement("div",{id:"contactPersonRole_err_msg",className:"invalid-feedback"},"Required")),r.a.createElement(d.c,{md:"4"},r.a.createElement(d.h,{label:"Contact Number",group:!0,value:this.state.contactPersonNumber,onChange:function(t){return e.onChange("contactPersonNumber",t.target.value)}}),r.a.createElement("div",{id:"contactPersonNumber_err_msg",className:"invalid-feedback"},"Required"))),r.a.createElement(d.q,null,r.a.createElement(d.c,{md:"5"},r.a.createElement(d.h,{label:"Enter Password",group:!0,type:"password",value:this.state.password,onChange:function(t){return e.onChange("password",t.target.value)}}),r.a.createElement("div",{id:"password_err_msg",className:"invalid-feedback"},"Required")),r.a.createElement(d.c,{md:"5"},r.a.createElement(d.h,{label:"Retype password",group:!0,type:"password",value:this.state.password_re,onChange:function(t){return e.onChange("password_re",t.target.value)}}),r.a.createElement("div",{id:"password_re_err_msg",className:"invalid-feedback"},"Passwords do not match")),r.a.createElement(d.c,{md:"2"},r.a.createElement(Fe.a,{control:r.a.createElement(xe.a,{checked:this.state.active,onChange:function(t){return e.onChange("active",t.target.checked)},name:"active"}),label:"Active"}))),r.a.createElement(d.q,null,r.a.createElement(d.c,null,r.a.createElement("div",{className:"text-center"},r.a.createElement(d.b,{outline:!0,color:"success",type:"submit"},"Register New User"),r.a.createElement(d.b,{outline:!0,color:"warning",onClick:this.resetForm},"Clear"))))))}}]),a}(n.Component),Ie=Object(m.b)((function(e){return{userData:e.userPoolData,userFilter:e.userFilter}}),(function(e){return{fetchUsers:function(){return e(b({url:"http://clients.patronish.com:4000/users/getAllUsers",callParams:{method:Y,headers:X,credentials:"include"},onSuccess:q.type,onFailure:q.type}))},updateUser:function(t,a){return e((n=t,r=a,b({url:"http://clients.patronish.com:4000/users/updateUser",callParams:{method:te,headers:X,credentials:"include",body:JSON.stringify({updatedUser:r,userEmail:n})},onSuccess:q.type,onFailure:q.type})));var n,r},removeUser:function(t){return e((a=t,b({url:"http://clients.patronish.com:4000/users/removeUser",callParams:{method:te,headers:X,credentials:"include",body:JSON.stringify({removedUser:a})},onSuccess:q.type,onFailure:q.type})));var a},checkUserExists:function(t,a){return e(ne(t,a))},addUser:function(t,a){return e(function(e,t){return b({url:"http://clients.patronish.com:4000/users/addUser",callParams:{method:te,headers:X,credentials:"include",body:JSON.stringify({newUser:e})},cb:t,onSuccess:q.type})}(t,a))},filterUsers:function(t){return e(se(t))}}}))(Me),Se=a(208),Le=a(108),qe=a.n(Le),De=a(107),Ae=a.n(De),Be=a(220),Ve=a(209),Te=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).columns=[{label:"#",field:"id"},{label:"Campaign",field:"name"},{label:"Campaign Balance",field:"balance"},{label:"Video Duration",field:"duration"},{label:"Intro Text",field:"intro"},{label:"URL",field:"url"},{label:"Manage",field:"manage"}],n.campaignManagementActions={addCampaign:"addCampaign",removeCampaign:"removeCampaign",updateCampaign:"updateCampaign"},n.state={rows:[],intro_len:300,startdate:new Date,enddate:new Date},n.manageCampaign=n.manageCampaign.bind(Object(ge.a)(n)),n.onChange=n.onChange.bind(Object(ge.a)(n)),n.resetForm=n.resetForm.bind(Object(ge.a)(n)),n.resetForm=n.resetForm.bind(Object(ge.a)(n)),n.checkCampaignURLExistsResponse=n.checkCampaignURLExistsResponse.bind(Object(ge.a)(n)),n.addCampaignResponse=n.addCampaignResponse.bind(Object(ge.a)(n)),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.campaignData||this.props.fetchCampaigns(this.props.email)}},{key:"onChange",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if("intro"===e&&(t.length>300&&(t=t.substring(0,300)),this.setState({intro_len:300-t.length})),"question"===e){var n=this.state.questions?this.state.questions:[];return a>=0?n[a]=t:n[n.length]="",void this.setState({questions:n})}if("question-r"===e){var r=this.state.questions;return a>=0&&(r[a]=null),void this.setState({questions:r})}"name"===e&&(document.getElementById("campaignNameExists_err_msg").style.display="none"),"url"===e&&(document.getElementById("campaignURLExists_err_msg").style.display="none");var s,i=document.getElementById("".concat(e.includes("date")?"date":e,"_err_msg"));(i&&(i.style.display="none"),"startdate"!==e)?this.setState(Object(pe.a)({},e,t)):this.setState((s={},Object(pe.a)(s,e,t),Object(pe.a)(s,"enddate",t),s))}},{key:"checkCampaignURLExistsResponse",value:function(e){if(console.log("response: ",e),e.success)document.getElementById("campaignURLExists_err_msg").style.display="block";else{var t=this.state.questions?this.state.questions.filter((function(e){return null!==e&&0!==e.length})):[],a={email:this.props.email,campaignURL:this.state.url,name:this.state.name,balance:parseInt("10"),duration:parseInt(this.state.duration),intro:this.state.intro,startdate:this.state.startdate.getTime(),enddate:this.state.enddate.getTime(),questions:t};console.log("new campaign: ",a),this.props.addCampaign(a,this.addCampaignResponse)}}},{key:"addCampaignResponse",value:function(e){console.log("response: ",e),e.success&&(this.props.filterCampaigns(N),this.props.fetchCampaigns(this.props.email))}},{key:"manageCampaign",value:function(e,t){var a,n=this;switch(e){case this.campaignManagementActions.updateCampaign:return;case this.campaignManagementActions.removeCampaign:return a=Object(g.a)({},this.props.campaignData.find((function(e){return e.campaignURL===t}))),void this.props.removeCampaign(a.campaignURL,(function(){return n.props.fetchCampaigns(n.props.email)}));case this.campaignManagementActions.addCampaign:return this.state.name?this.state.duration?this.state.url?this.state.startdate&&this.state.enddate?void this.props.checkCampaignURLExists(this.state.url,this.checkCampaignURLExistsResponse):void(document.getElementById("date_err_msg").style.display="block"):void(document.getElementById("url_err_msg").style.display="block"):void(document.getElementById("duration_err_msg").style.display="block"):void(document.getElementById("name_err_msg").style.display="block");default:return void console.log("will act as default")}}},{key:"resetForm",value:function(){this.setState({name:"",url:"",duration:"",intro:"",startdate:new Date,enddate:new Date,questions:null})}},{key:"render",value:function(){var e=this;if(this.props.campaignFilter===N||this.props.campaignFilter===j||this.props.campaignFilter===_){var t;if(console.log("Campaign data: ",this.props.campaignData),this.props.campaignData&&this.props.campaignData.length>0){var a=1;t=this.props.campaignData.map((function(t){return{id:a++,name:t.name,balance:t.balance,duration:t.duration,intro:t.intro,url:t.campaignURL,action:r.a.createElement(Ue,{trigger:function(e){e.isOpen;var t=e.triggerRef,a=e.toggle;return r.a.createElement("button",{type:"button",className:"btn btn-outline-primary","data-ripple-color":"dark",ref:t,onClick:a},"Manage Campaign")},id:t.campaignURL,options:[{name:function(){return"Edit Campaign"},action:e.campaignManagementActions.updateCampaign},{name:function(){return"Delete Campaign"},action:e.campaignManagementActions.removeCampaign}],callback:e.manageCampaign})}}))}return r.a.createElement(d.r,{btn:!0},r.a.createElement(d.t,{columns:this.columns}),r.a.createElement(d.s,{rows:t}))}if(this.props.campaignFilter===w){var n=this.state.questions?r.a.createElement(r.a.Fragment,null,this.state.questions.map((function(t,a){return null===t?r.a.createElement(r.a.Fragment,null):r.a.createElement(d.q,{key:a},r.a.createElement(d.c,{md:"11"},r.a.createElement(d.h,{type:"text",group:!0,value:t,onChange:function(t){return e.onChange("question",t.target.value,a)}})),r.a.createElement(d.c,{md:"1"},r.a.createElement(Se.a,{size:"small",className:"mt-4 ml-2",onClick:function(t){return e.onChange("question-r",null,a)}},r.a.createElement(Ae.a,null))))}))):r.a.createElement(r.a.Fragment,null);return r.a.createElement("form",{className:"needs-validation",onSubmit:function(t){t.preventDefault(),e.manageCampaign(e.campaignManagementActions.addCampaign)}},r.a.createElement(d.e,null,r.a.createElement(d.q,null,r.a.createElement(d.c,{md:"6"},r.a.createElement(d.h,{label:"Campaign Name",group:!0,value:this.state.name,onChange:function(t){return e.onChange("name",t.target.value)}}),r.a.createElement("div",{id:"name_err_msg",className:"invalid-feedback"},"Required"),r.a.createElement("div",{id:"campaignNameExists_err_msg",className:"invalid-feedback"},"This campaign name is taken")),r.a.createElement(d.c,{md:"6"},r.a.createElement(d.h,{label:"Video Duration (sec)",group:!0,type:"number",value:this.state.duration,onChange:function(t){return e.onChange("duration",t.target.value)}}),r.a.createElement("div",{id:"duration_err_msg",className:"invalid-feedback"},"Required"))),r.a.createElement(d.q,null,r.a.createElement(d.c,{md:"12"},r.a.createElement(d.h,{label:"Campaign URL (no spaces) https://story.patronish.com/",group:!0,value:this.state.url,onChange:function(t){return e.onChange("url",t.target.value)}}),r.a.createElement("div",{id:"url_err_msg",className:"invalid-feedback"},"Valid URL Required (no spaces)"),r.a.createElement("div",{id:"campaignURLExists_err_msg",className:"invalid-feedback"},"This campaign URL is taken"))),r.a.createElement(d.q,null,r.a.createElement(d.c,{md:"12"},r.a.createElement(d.h,{label:"Campaign Introduction Text (optional - ".concat(this.state.intro_len,")"),group:!0,type:"textarea",value:this.state.intro,onChange:function(t){return e.onChange("intro",t.target.value)}}))),r.a.createElement(d.q,{className:"mb-4"},r.a.createElement(d.c,{md:"6"},r.a.createElement(Be.a,{label:"Start Date",autoOk:!0,variant:"inline",minDate:new Date,inputVariant:"outlined",format:"dd/MM/yyyy",InputAdornmentProps:{position:"start"},value:this.state.startdate,onChange:function(t){return e.onChange("startdate",t)}})),r.a.createElement(d.c,null,r.a.createElement(Be.a,{label:"End Date",autoOk:!0,variant:"inline",minDate:this.state.startdate,inputVariant:"outlined",format:"dd/MM/yyyy",InputAdornmentProps:{position:"start"},value:this.state.enddate,onChange:function(t){return e.onChange("enddate",t)}}))),r.a.createElement(d.q,null,r.a.createElement(d.c,null,r.a.createElement("div",{id:"date_err_msg",className:"invalid-feedback"},"Please select valid date(s) with at-least 1 day duration"))),n,r.a.createElement(d.q,null,r.a.createElement(d.c,null,r.a.createElement(Ve.a,{variant:"outlined",startIcon:r.a.createElement(qe.a,null),onClick:function(){return e.onChange("question")}},"Add Question"))),r.a.createElement(d.q,null,r.a.createElement(d.c,null,r.a.createElement("div",{className:"text-center"},r.a.createElement(d.b,{outline:!0,color:"success",type:"submit"},"Add New Campaign"),r.a.createElement(d.b,{outline:!0,color:"warning",onClick:this.resetForm},"Clear"))))))}return r.a.createElement("h1",null,"Campaign Module Under Construction...")}}]),a}(n.Component),ze=Object(m.b)((function(e){return{email:e.userData.email,campaignData:e.campaignList,campaignFilter:e.campaignFilter}}),(function(e){return{fetchCampaigns:function(t){return e(oe(t))},updateCampaign:function(t,a){return e(function(e,t){return b({url:Q+"/updateCampaign/"+e,callParams:{method:ee,headers:X,credentials:"include",body:JSON.stringify({updatedCampaign:t})},onSuccess:B.type,onFailure:B.type})}(t,a))},removeCampaign:function(t,a){return e(function(e,t){return b({url:Q+"/removeCampaign/"+e,callParams:{method:ae,headers:X,credentials:"include"},cb:t})}(t,a))},checkCampaignURLExists:function(t,a){return e(function(e,t){return b({url:Q+"/campaignURLExists/"+e,callParams:{method:Y,headers:X,credentials:"include"},cb:t})}(t,a))},addCampaign:function(t,a){return e(function(e,t){return b({url:"http://clients.patronish.com:4000/campaigns/addCampaign",callParams:{method:te,headers:X,credentials:"include",body:JSON.stringify({newCampaign:e})},cb:t,onSuccess:B.type})}(t,a))},filterCampaigns:function(t){return e(ie(t))}}}))(Te),Je=a(109),He=a.n(Je),We=(a(168),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).player={},e}return Object(l.a)(a,[{key:"onPlayerReady",value:function(e){this.player=e}},{key:"onVideoPlay",value:function(e){}},{key:"onVideoEnd",value:function(){}},{key:"render",value:function(){return null==this.props.src?r.a.createElement(r.a.Fragment,null):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{height:"100%"}},r.a.createElement(He.a,{className:"player video-js",controls:!0,src:{src:this.props.src,type:"video/mp4"},onReady:this.onPlayerReady.bind(this),onPlay:this.onVideoPlay.bind(this),onEnd:this.onVideoEnd.bind(this)})))}}]),a}(n.Component)),$e=a(210),Ze=a(211),Ge=a(212),Ke=a(213),Qe=a(216),Xe=a(217),Ye=a(214),et=a(215),tt=a(218),at=a(219),nt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).generateTable=n.generateTable.bind(Object(ge.a)(n)),n.downloadVideo=n.downloadVideo.bind(Object(ge.a)(n)),n.playVideo=n.playVideo.bind(Object(ge.a)(n)),n.closeVideo=n.closeVideo.bind(Object(ge.a)(n)),n.state={videoUrl:void 0},n}return Object(l.a)(a,[{key:"generateTable",value:function(){var e=this;if(!this.props.albumList)return r.a.createElement("h3",null,"No album selected");if(0===this.props.albumList.length)return r.a.createElement("h3",null,"No videos in this album");var t=this.props.albumList.map((function(t,a){return r.a.createElement("tr",{key:t.key},r.a.createElement("td",null,a+1),r.a.createElement("td",null,t.key),r.a.createElement("td",null,r.a.createElement("div",null,r.a.createElement("button",{type:"button",className:"btn btn-outline-success","data-ripple-color":"dark",onClick:function(){e.props.overlay(),e.playVideo(t.url)}},"Play"),r.a.createElement("button",{type:"button",className:"btn btn-outline-primary","data-ripple-color":"dark",onClick:function(){return e.downloadVideo(t.url)}},"Download"),r.a.createElement("button",{type:"button",className:"btn btn-outline-danger","data-ripple-color":"dark",onClick:function(){e.props.overlay(),e.props.deleteVideo(t.key)}},"Delete"))),r.a.createElement("td",null,r.a.createElement("div",null,r.a.createElement($e.a,{style:{margin:"10px"},url:t.url,quote:e.props.albumName},r.a.createElement(Ze.a,{size:36})),r.a.createElement(Ge.a,{style:{margin:"10px"},url:t.url,title:e.props.albumName},r.a.createElement(Ke.a,{size:36})),r.a.createElement(Ye.a,{style:{margin:"10px"},url:t.url,title:e.props.albumName},r.a.createElement(et.a,{size:36})),r.a.createElement(Qe.a,{style:{margin:"10px"},url:t.url,title:e.props.albumName},r.a.createElement(Xe.a,{size:36})),r.a.createElement(tt.a,{style:{margin:"10px"},url:t.url,title:e.props.albumName,source:"http://clients.patronish.com"},r.a.createElement(at.a,{size:36})))))}));return r.a.createElement("table",{id:"playlist"},r.a.createElement("tbody",null,t))}},{key:"playVideo",value:function(e){this.setState({videoUrl:e})}},{key:"closeVideo",value:function(){this.setState({videoUrl:void 0}),this.props.closeVideo()}},{key:"downloadVideo",value:function(e){window.location.href=e}},{key:"render",value:function(){var e=this,t=this.generateTable(),a="none";return this.state.videoUrl&&(a="block"),r.a.createElement("div",null,r.a.createElement("div",{id:"overlay",className:"overlay",style:{display:a}}),this.props.albumName?r.a.createElement("h1",null,"Campaign ",r.a.createElement("b",null,this.props.albumName)):r.a.createElement(r.a.Fragment,null),r.a.createElement("div",{id:"playlistWrapper",className:"playlist"},t),r.a.createElement("div",{id:"player",className:"playerWrapper",style:{display:a}},r.a.createElement("button",{className:"closeButton",onClick:function(){return e.closeVideo()}},"\u2716"),this.state.videoUrl?r.a.createElement(We,{src:this.state.videoUrl}):r.a.createElement(r.a.Fragment,null)))}}]),a}(n.Component),rt=Object(m.b)((function(e){return{campaignFilter:e.campaignData,albumName:e.albumName,albumList:e.albumList,videoUrl:e.videoUrl}}),(function(e){return{deleteVideo:function(t){return e(function(e){var t=Q+"/removeCampaignVideo/"+e.replace("/","$");return b({url:t,callParams:{method:ae,headers:X,credentials:"include"},onSuccess:T.type,onFailure:T.type})}(t))},closeVideo:function(){return e(z({}))},overlay:function(){return e(Z())}}}))(nt),st=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(ce,null),r.a.createElement(de,null),r.a.createElement("div",{style:{marginLeft:"270px",marginTop:"64px",padding:"10px"}},this.props.activeModule===f.user?r.a.createElement(Ie,null):"",this.props.activeModule===f.campaign?r.a.createElement(ze,null):"",this.props.activeModule===f.video?r.a.createElement(rt,null):""))}}]),a}(n.Component),it=Object(m.b)((function(e){return{activeModule:e.activeModule}}),(function(e){return{}}))(st);function ot(e){var t=e.classes,a=e.prepend,n=e.text,s=e.append,i=e.callback;return r.a.createElement("p",{className:t},a,r.a.createElement("strong",{style:{cursor:"pointer"},onClick:function(){return i()}},n),s)}var lt="success",ct="error",ut=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onChange=n.onChange.bind(Object(ge.a)(n)),n.initLogin=n.initLogin.bind(Object(ge.a)(n)),n.notify=n.notify.bind(Object(ge.a)(n)),n.state={},n}return Object(l.a)(a,[{key:"onChange",value:function(e,t){this.setState(Object(pe.a)({},e,t))}},{key:"initLogin",value:function(){this.props.login(this.state.email,this.state.password,this.notify)}},{key:"notify",value:function(e){e.success?this.props.notify(lt,"Login successful"):this.props.notify(ct,e.message)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{style:{height:"100vh"}},r.a.createElement("div",{className:"bg-dark col-12 container h-100"},r.a.createElement("div",{className:"row align-items-center h-100"},r.a.createElement("div",{className:"col-sm-10 col-md-8 col-lg-6 col-xl-4  mx-auto"},r.a.createElement(d.e,null,r.a.createElement(d.q,null,r.a.createElement(d.c,{md:"12"},r.a.createElement("p",{className:"h3 text-white text-center mb-4"},"Sign in"),r.a.createElement("div",{className:"grey-text"},r.a.createElement(d.h,{label:"Email",icon:"envelope",group:!0,type:"email",validate:!0,error:"wrong email address format",success:"right",onChange:function(t){return e.onChange("email",t.target.value)}}),r.a.createElement(d.h,{label:"Type your password",icon:"lock",group:!0,type:"password",validate:!0,onChange:function(t){return e.onChange("password",t.target.value)}})),r.a.createElement("div",{className:"text-right"},r.a.createElement(ot,{classes:"text-white",text:"Reset Password",callback:function(){return e.props.navigate(f.passwordReset)}})),r.a.createElement("div",{className:"text-center"},r.a.createElement(d.b,{onClick:this.initLogin},"Login")),r.a.createElement("div",{className:"text-center mt-3"},r.a.createElement(ot,{classes:"text-white",prepend:"Don't have an account? ",text:"Register",callback:function(){return e.props.navigate(f.register)}})))))))))}}]),a}(n.Component),mt=Object(m.b)((function(e){return{loading:e.loading}}),(function(e){return{login:function(t,a,n){return e(function(e,t,a){return b({url:"http://clients.patronish.com:4000/users/login",callParams:{method:te,headers:X,credentials:"include",body:JSON.stringify({email:e,password:t})},cb:a,onSuccess:S.type,onFailure:S.type})}(t,a,n))},navigate:function(t){return e(re(t))}}}))(ut),dt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onChange=n.onChange.bind(Object(ge.a)(n)),n.initRegister=n.initRegister.bind(Object(ge.a)(n)),n.checkUserExistsResponse=n.checkUserExistsResponse.bind(Object(ge.a)(n)),n.resetForm=n.resetForm.bind(Object(ge.a)(n)),n.notify=n.notify.bind(Object(ge.a)(n)),n.state={companyName:void 0},n}return Object(l.a)(a,[{key:"onChange",value:function(e,t){this.setState(Object(pe.a)({},e,t));var a=document.getElementById("".concat(e,"_err_msg"));a&&(a.style.display="none","contactPersonEmail"===e&&(document.getElementById("contactPersonEmailExists_err_msg").style.display="none"))}},{key:"initRegister",value:function(){this.state.companyName?this.state.location?this.state.postCode?this.state.country?this.state.contactPersonName?this.state.contactPersonEmail&&R(this.state.contactPersonEmail)?this.state.contactPersonRole?this.state.contactPersonNumber?this.state.password?this.state.password===this.state.password_re?this.props.checkUserExists(this.state.contactPersonEmail,this.checkUserExistsResponse):document.getElementById("password_re_err_msg").style.display="block":document.getElementById("password_err_msg").style.display="block":document.getElementById("contactPersonNumber_err_msg").style.display="block":document.getElementById("contactPersonRole_err_msg").style.display="block":document.getElementById("contactPersonEmail_err_msg").style.display="block":document.getElementById("contactPersonName_err_msg").style.display="block":document.getElementById("country_err_msg").style.display="block":document.getElementById("postCode_err_msg").style.display="block":document.getElementById("location_err_msg").style.display="block":document.getElementById("companyName_err_msg").style.display="block"}},{key:"checkUserExistsResponse",value:function(e){if(console.log("exists response: ",e),e.success)return console.log("in?"),void(document.getElementById("contactPersonEmailExists_err_msg").style.display="block");console.log("right after");var t=this.state,a=t.companyName,n=t.location,r=t.postCode,s=t.country,i=t.employeeSize,o=t.contactPersonName,l=t.contactPersonEmail,c=t.contactPersonRole,u=t.contactPersonNumber,m={name:o,email:l,password:t.password,role:c,contact:u,company:{name:a,location:n,postCode:r,country:s,employeeSize:i||-1}};console.log("new user: ",m),this.props.addUser(m,this.notify)}},{key:"resetForm",value:function(){this.setState({companyName:"",location:"",postCode:"",country:"",employeeSize:"",contactPersonName:"",contactPersonEmail:"",contactPersonRole:"",contactPersonNumber:"",password:"",password_re:""})}},{key:"notify",value:function(e){e.success?(this.props.notify(lt,"Registration successful"),this.props.navigate(f.login)):this.props.notify(ct,e.message)}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{height:"100vh"}},r.a.createElement("div",{className:"bg-dark col-12 container h-100"},r.a.createElement("div",{className:"row align-items-center h-100"},r.a.createElement("div",{className:"col-sm-10 col-md-8 col-lg-6 col-xl-4  mx-auto"},r.a.createElement("form",{className:"needs-validation",onSubmit:function(t){t.preventDefault(),e.initRegister()}},r.a.createElement(d.e,null,r.a.createElement(d.q,null,r.a.createElement(d.c,{md:"12"},r.a.createElement("p",{id:"x",className:"h3 text-center text-white mb-4"},"Company"),r.a.createElement(d.h,{label:"Company Name",group:!0,value:this.state.companyName,onChange:function(t){return e.onChange("companyName",t.target.value)}}),r.a.createElement("div",{id:"companyName_err_msg",className:"invalid-feedback"},"Required"),r.a.createElement(d.h,{label:"Location",group:!0,value:this.state.location,onChange:function(t){return e.onChange("location",t.target.value)}}),r.a.createElement("div",{id:"location_err_msg",className:"invalid-feedback"},"Required"))),r.a.createElement(d.q,null,r.a.createElement(d.c,{md:"4"},r.a.createElement(d.h,{label:"Post Code",group:!0,type:"number",value:this.state.postCode,onChange:function(t){return e.onChange("postCode",t.target.value)}}),r.a.createElement("div",{id:"postCode_err_msg",className:"invalid-feedback"},"Required")),r.a.createElement(d.c,{md:"4"},r.a.createElement(d.h,{label:"Country",group:!0,value:this.state.country,onChange:function(t){return e.onChange("country",t.target.value)}}),r.a.createElement("div",{id:"country_err_msg",className:"invalid-feedback"},"Required")),r.a.createElement(d.c,{md:"4"},r.a.createElement(d.h,{label:"Employee Size",group:!0,value:this.state.employeeSize,onChange:function(t){return e.onChange("employeeSize",t.target.value)}}))),r.a.createElement(d.q,null,r.a.createElement(d.c,null,r.a.createElement("p",{id:"x",className:"h3 text-center text-white mb-4 mt-3"},"Contact Person (Account Holder)"),r.a.createElement(d.h,{label:"Name",group:!0,value:this.state.contactPersonName,onChange:function(t){return e.onChange("contactPersonName",t.target.value)}}),r.a.createElement("div",{id:"contactPersonName_err_msg",className:"invalid-feedback"},"Required"))),r.a.createElement(d.q,null,r.a.createElement(d.c,{md:"4"},r.a.createElement(d.h,{label:"Email (used as login credential)",group:!0,type:"email",value:this.state.contactPersonEmail,onChange:function(t){return e.onChange("contactPersonEmail",t.target.value)}}),r.a.createElement("div",{id:"contactPersonEmail_err_msg",className:"invalid-feedback"},"Required"),r.a.createElement("div",{id:"contactPersonEmailExists_err_msg",className:"invalid-feedback"},"Email address already in use")),r.a.createElement(d.c,{md:"4"},r.a.createElement(d.h,{label:"Role",group:!0,value:this.state.contactPersonRole,onChange:function(t){return e.onChange("contactPersonRole",t.target.value)}}),r.a.createElement("div",{id:"contactPersonRole_err_msg",className:"invalid-feedback"},"Required")),r.a.createElement(d.c,{md:"4"},r.a.createElement(d.h,{label:"Contact Number",group:!0,value:this.state.contactPersonNumber,onChange:function(t){return e.onChange("contactPersonNumber",t.target.value)}}),r.a.createElement("div",{id:"contactPersonNumber_err_msg",className:"invalid-feedback"},"Required"))),r.a.createElement(d.q,null,r.a.createElement(d.c,{md:"6"},r.a.createElement(d.h,{label:"Enter Password",group:!0,type:"password",value:this.state.password,onChange:function(t){return e.onChange("password",t.target.value)}}),r.a.createElement("div",{id:"password_err_msg",className:"invalid-feedback"},"Required")),r.a.createElement(d.c,{md:"6"},r.a.createElement(d.h,{label:"Retype password",group:!0,type:"password",value:this.state.password_re,onChange:function(t){return e.onChange("password_re",t.target.value)}}),r.a.createElement("div",{id:"password_re_err_msg",className:"invalid-feedback"},"Passwords do not match"))),r.a.createElement(d.q,null,r.a.createElement(d.c,null,r.a.createElement("div",{className:"text-center"},r.a.createElement(d.b,{type:"submit"},"Register New User"),r.a.createElement(d.b,{onClick:this.resetForm},"Clear")))))))))),r.a.createElement(d.b,{outline:!0,color:"success",style:{position:"absolute",top:"0%",right:"0%"},onClick:function(){return e.props.navigate(f.login)}},"Login"))}}]),a}(n.Component),pt=Object(m.b)((function(e){return{loading:e.loading}}),(function(e){return{checkUserExists:function(t,a){return e(ne(t,a))},addUser:function(t,a){return e(function(e,t){return b({url:"http://clients.patronish.com:4000/users/register",callParams:{method:te,headers:X,credentials:"include",body:JSON.stringify({newUser:e})},cb:t})}(t,a))},navigate:function(t){return e(re(t))}}}))(dt),gt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onChange=n.onChange.bind(Object(ge.a)(n)),n.generateOTP=n.generateOTP.bind(Object(ge.a)(n)),n.generateOTPResponse=n.generateOTPResponse.bind(Object(ge.a)(n)),n.initPasswordReset=n.initPasswordReset.bind(Object(ge.a)(n)),n.passwordResetResponse=n.passwordResetResponse.bind(Object(ge.a)(n)),n.notify=n.notify.bind(Object(ge.a)(n)),n.state={emailInputDisabled:!1},n}return Object(l.a)(a,[{key:"onChange",value:function(e,t){var a=document.getElementById("".concat(e,"_err_msg"));a&&(a.style.display="none"),this.setState(Object(pe.a)({},e,t))}},{key:"generateOTP",value:function(e){console.log("At generateOTP response: ",e),e?e.success?this.props.generateOTP(this.state.email,this.generateOTPResponse):(this.setState({emailInputDisabled:!1}),document.getElementById("email_err_msg").style.display="block"):(this.setState({emailInputDisabled:!0}),this.props.checkUserExists(this.state.email,this.generateOTP))}},{key:"generateOTPResponse",value:function(e){return console.log("At generateOTPResponse response: ",e),e.success?(document.getElementById("email_info_msg").style.display="block",void this.notify({success:!0,message:"OTP generation success"})):void this.notify(e)}},{key:"initPasswordReset",value:function(){var e=this.state,t=e.email,a=e.otp,n=e.password;n===e.password_re?a?this.props.passwordReset(t,a,n,this.passwordResetResponse):document.getElementById("otp_err_msg").style.display="block":document.getElementById("password_re_err_msg").style.display="block"}},{key:"passwordResetResponse",value:function(e){e.success&&this.props.navigate(f.login),this.notify(e)}},{key:"notify",value:function(e){console.log("At notify response: ",e),e.success?e.message?this.props.notify(lt,e.message):this.props.notify(lt,"Password Reset Successful"):(e.message&&this.props.notify(ct,e.message),e.err&&this.props.notify(ct,e.err))}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{height:"100vh"}},r.a.createElement("div",{className:"bg-dark col-12 container h-100"},r.a.createElement("div",{className:"row align-items-center h-100"},r.a.createElement("div",{className:"col-sm-10 col-md-8 col-lg-6 col-xl-4 grey-text mx-auto"},r.a.createElement(d.e,null,r.a.createElement(d.q,null,r.a.createElement(d.c,null,r.a.createElement("p",{className:"h3 text-white text-center mb-4"},"Reset Password"))),r.a.createElement(d.q,null,r.a.createElement(d.c,{md:"12"},r.a.createElement(d.h,{label:"Email",icon:"envelope",group:!0,type:"email",validate:!0,error:"wrong email address format",value:this.state.email,disabled:this.state.emailInputDisabled,onChange:function(t){return e.onChange("email",t.target.value)}}),r.a.createElement("div",{id:"email_err_msg",className:"invalid-feedback"},"Email not found"),r.a.createElement("div",{id:"email_info_msg",className:"valid-feedback"},"OTP has been sent to your email, it is valid for next 10 minutes"))),r.a.createElement(d.q,null,r.a.createElement(d.c,null,r.a.createElement("div",{className:"text-center"},r.a.createElement(d.b,{onClick:function(){return e.generateOTP()}},"Send OTP Email")))),r.a.createElement(d.q,null,r.a.createElement(d.c,null,r.a.createElement(d.h,{label:"Enter OTP (received by email)",icon:"lock",group:!0,onChange:function(t){return e.onChange("otp",t.target.value)}}),r.a.createElement("div",{id:"otp_err_msg",className:"invalid-feedback"},"Required"))),r.a.createElement(d.q,null,r.a.createElement(d.c,null,r.a.createElement(d.h,{label:"Type new password",icon:"lock",group:!0,type:"password",onChange:function(t){return e.onChange("password",t.target.value)}}))),r.a.createElement(d.q,null,r.a.createElement(d.c,null,r.a.createElement(d.h,{label:"Re-type new password",icon:"lock",group:!0,type:"password",onChange:function(t){return e.onChange("password_re",t.target.value)}}),r.a.createElement("div",{id:"password_re_err_msg",className:"invalid-feedback"},"Passwords do not match"))),r.a.createElement(d.q,null,r.a.createElement(d.c,null,r.a.createElement("div",{className:"text-center"},r.a.createElement(d.b,{onClick:this.initPasswordReset},"Reset Password"))))))))),r.a.createElement(d.b,{outline:!0,color:"success",style:{position:"absolute",top:"0%",right:"0%"},onClick:function(){return e.props.navigate(f.login)}},"Login"))}}]),a}(n.Component),ht=Object(m.b)((function(e){return{loading:e.loading}}),(function(e){return{checkUserExists:function(t,a){return e(ne(t,a))},generateOTP:function(t,a){return e(function(e,t){return b({url:"http://clients.patronish.com:4000/users/otp/"+e,callParams:{method:Y,headers:X,credentials:"include"},cb:t})}(t,a))},passwordReset:function(t,a,n,r){return e(function(e,t,a,n){return b({url:"http://clients.patronish.com:4000/users/passwordReset",callParams:{method:te,headers:X,credentials:"include",body:JSON.stringify({email:e,otp:t,password:a})},cb:n})}(t,a,n,r))},navigate:function(t){return e(re(t))}}}))(gt),vt=a(58),bt=(a(169),a(170),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.loggedIn||this.props.onPageLoad()}},{key:"notify",value:function(e,t){switch(e){case lt:vt.b.success(t,{position:"top-right",autoClose:3e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!1,draggable:!0,progress:void 0});break;case ct:vt.b.error(t,{position:"top-right",autoClose:3e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!1,draggable:!0,progress:void 0});break;default:vt.b.warn("Invalid notification issue",{position:"top-right",autoClose:5e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!1,draggable:!0,progress:void 0})}}},{key:"render",value:function(){var e="none";return this.props.loading&&(e="block"),this.props.loggedIn?r.a.createElement(r.a.Fragment,null,r.a.createElement(vt.a,{position:"top-right",autoClose:1e3,hideProgressBar:!0,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!1,draggable:!0,pauseOnHover:!1}),r.a.createElement("div",{id:"loader",className:"loader",style:{display:e}}),r.a.createElement("div",{id:"overlay",className:"overlay",style:{display:e}}),r.a.createElement(it,null)):r.a.createElement(r.a.Fragment,null,r.a.createElement(vt.a,{position:"top-right",autoClose:1e3,hideProgressBar:!0,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!1,draggable:!0,pauseOnHover:!1}),this.props.activeModule===f.login?r.a.createElement(mt,{notify:this.notify}):r.a.createElement(r.a.Fragment,null),this.props.activeModule===f.register?r.a.createElement(pt,{notify:this.notify}):r.a.createElement(r.a.Fragment,null),this.props.activeModule===f.passwordReset?r.a.createElement(ht,{notify:this.notify}):r.a.createElement(r.a.Fragment,null))}}]),a}(n.Component)),ft=Object(m.b)((function(e){return{loading:e.loading,loggedIn:e.loggedIn,activeModule:e.activeModule}}),(function(e){return{onPageLoad:function(){return e(b({url:"http://clients.patronish.com:4000/users/getSessionUser",callParams:{method:Y,headers:X,credentials:"include"},onSuccess:I.type,onFailure:I.type}))}}}))(bt);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var yt=a(26),Et=a(79),Ct=a.n(Et),kt=a(110);function Ot(e,t){0}var Nt=function(e){return function(t){return function(){var a=Object(kt.a)(Ct.a.mark((function a(n){var r,s,i,o,l,c,u;return Ct.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=e.dispatch,Ot("action",n),n.type===b.type){a.next=4;break}return a.abrupt("return",t(n));case 4:s=n.payload,i=s.onSuccess,o=s.onFailure,l=s.url,c=s.callParams,u=s.cb,Ot("url",n.payload.url),fetch(l,Object(g.a)({},c)).then((function(e){return e.json()})).then((function(e){Ot("response",e),u&&"function"===typeof u&&u(e),i&&r({type:i,payload:e})})).catch((function(e){Ot("error",e),o&&r({type:o,payload:e})}));case 7:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()}},jt=Object(h.a)({reducer:G,middleware:[].concat(Object(yt.a)(Object(h.d)()),[Nt])}),_t=(a(172),a(173),a(174),a(111)),wt=a(27);i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(m.a,{store:jt},r.a.createElement(wt.a,{utils:_t.a},r.a.createElement(ft,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[135,1,2]]]);
//# sourceMappingURL=main.5787842e.chunk.js.map